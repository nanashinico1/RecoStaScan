# RecoStaScan

RecotteStudioのプロジェクトファイル（.ccproj）をスキャンし、キャラクターやセリフを検索するWindows Forms アプリケーション

## 概要

RecoStaScanは、動画編集ソフト「RecotteStudio」で作成されたプロジェクトファイル（.ccprojファイル）を効率的にスキャンし、以下の機能を提供します：

- プロジェクトファイルの一括スキャン
- 特定のキャラクター（話者）での検索
- 特定のセリフ（テキスト）での検索
- プロジェクト詳細表示と個別検索
- キャッシュ機能による高速スキャン
- 重複ファイルの自動フィルタリング

## 主な機能

### 1. フォルダスキャン
- 指定フォルダ内の全.ccprojファイルを一括スキャン
- プロジェクト名、キャラクター数、テキスト数を表示

### 2. 検索機能
- **キャラクター検索**: 特定の話者が使用されているプロジェクトを検索
- **テキスト検索**: 特定のセリフが含まれるプロジェクトを検索
- 大文字小文字を区別しない検索

### 3. キャッシュ機能
- スキャン結果を自動保存（`%LOCALAPPDATA%\RecoStaScan\scan_cache.json`）
- ファイルの変更を検知し、変更されていないファイルは再スキャンをスキップ
- 手動でキャッシュのクリアが可能

### 4. 重複ファイル処理
- 同名プロジェクトの重複ファイルを自動検出
- 最新の更新日時のファイルのみを処理対象とする
- 重複ファイル一覧の表示機能

### 5. プロジェクト詳細表示
- 個別プロジェクトの詳細情報表示
- 話者一覧、テキスト一覧の表示
- プロジェクト内でのテキスト検索とハイライト表示

## システム要件

- **OS**: Windows 10/11
- **.NET**: .NET 8.0 Runtime
- **開発環境**: Visual Studio 2022 (開発時)

## 使用方法

### 1. 基本的な使い方

1. **フォルダ選択**: 「フォルダ選択」ボタンでccprojファイルが含まれるフォルダを選択
2. **スキャン実行**: 「スキャン開始」ボタンでスキャンを開始
3. **結果確認**: スキャン結果が一覧表示される

### 2. 検索機能

- **キャラクター検索**: 検索ボックスにキャラクター名を入力し「キャラクター検索」ボタンをクリック
- **テキスト検索**: 検索ボックスにテキストを入力し「テキスト検索」ボタンをクリック
- **フィルタクリア**: 「フィルタクリア」ボタンで検索結果をリセット

### 3. プロジェクト詳細

- 結果一覧でプロジェクトをダブルクリックすると詳細画面が開く
- 詳細画面では話者一覧とテキスト一覧を確認できる
- 詳細画面内でもテキスト検索が可能（マッチした行がハイライト表示）

### 4. キャッシュ機能

- **キャッシュ使用**: 「キャッシュを使用」チェックボックスでキャッシュの有効/無効を切り替え
- **キャッシュクリア**: 「キャッシュクリア」ボタンで保存されたキャッシュを削除

### 5. 重複ファイル処理

- **重複フィルタ**: 「重複ファイルをフィルタ」チェックボックスで重複処理の有効/無効を切り替え
- **重複表示**: 「重複ファイル表示」ボタンで重複ファイル一覧を表示

## 技術仕様

### アーキテクチャ
- **言語**: C# (.NET 8.0)
- **UI**: Windows Forms
- **JSON解析**: Newtonsoft.Json

### 主要クラス

#### CcprojParser
- ccprojファイルの解析
- JSON構造からテキストと話者情報を抽出
- ディレクトリスキャン機能

#### CacheManager
- キャッシュの保存・読み込み
- ファイル変更検知
- キャッシュ統計情報の提供

#### MainForm
- メイン画面のUI制御
- 検索機能の実装
- 進捗表示

#### DetailForm
- プロジェクト詳細画面
- 個別検索機能
- 動的レイアウト調整

### データ構造

ccprojファイルから以下の情報を抽出：

```json
{
  "FileName": "ファイル名",
  "ProjectName": "プロジェクト名",
  "Speakers": [
    {
      "Name": "話者名",
      "FilePath": "音声ファイルパス"
    }
  ],
  "Texts": [
    {
      "Text": "テキスト内容",
      "StartTime": 開始時刻,
      "EndTime": 終了時刻,
      "SpeakerName": "話者名"
    }
  ]
}
```

## キャッシュについて

### 保存場所
```
%LOCALAPPDATA%\RecoStaScan\scan_cache.json
```

### キャッシュの仕組み
- ファイルサイズと最終更新日時でファイル変更を検知
- 変更されていないファイルは解析をスキップし、キャッシュから読み込み
- 削除されたファイルのキャッシュエントリは自動除去

## ビルド方法

### 前提条件
- Visual Studio 2022
- .NET 8.0 SDK

### ビルド手順
```bash
# リポジトリのクローン
git clone <repository-url>
cd RecoStaScan

# プロジェクトのビルド
dotnet build

# 実行
dotnet run
```

## 注意事項

- ccprojファイルのJSON構造は RecotteStudio のバージョンによって変更される可能性があります
- 大量のファイルをスキャンする場合は初回に時間がかかる場合があります
- キャッシュファイルは手動で削除しても問題ありません

## ライセンス

このプロジェクトは個人使用を目的として作成されています。

## 開発者

このアプリケーションは Claude Code を使用して開発されました。